import GameMap from "./gameMap";
import { EUnit } from "./models/types";
import { ECountry, ETerrain } from "./sprites";
import "./style.css";

const sampleMap = [
  [36, 22, 123, 28, 18, 34, 15, 15, 34, 15, 19, 1, 34, 22, 15, 34, 112],
  [25, 35, 3, 26, 20, 3, 1, 1, 1, 3, 16, 1, 3, 16, 1, 21, 19],
  [123, 3, 7, 9, 1, 1, 34, 1, 1, 1, 16, 1, 1, 16, 1, 1, 16],
  [28, 27, 9, 34, 3, 18, 20, 3, 18, 34, 20, 3, 18, 34, 1, 3, 23],
  [18, 20, 1, 3, 125, 20, 1, 18, 20, 1, 1, 1, 16, 1, 1, 1, 34],
  [34, 3, 1, 18, 20, 3, 18, 34, 3, 1, 133, 1, 21, 15, 15, 15, 20],
  [16, 1, 34, 20, 1, 18, 20, 1, 18, 15, 20, 1, 1, 1, 1, 3, 1],
  [16, 1, 1, 3, 18, 34, 3, 18, 23, 3, 1, 1, 3, 34, 15, 15, 19],
  [34, 1, 1, 18, 20, 1, 1, 21, 145, 19, 1, 1, 18, 20, 1, 1, 34],
  [21, 15, 15, 34, 3, 1, 1, 3, 25, 20, 3, 34, 20, 3, 1, 1, 16],
  [1, 3, 1, 1, 1, 1, 18, 15, 20, 1, 18, 20, 1, 18, 34, 1, 16],
  [18, 15, 15, 15, 19, 1, 133, 1, 3, 34, 20, 3, 18, 20, 1, 3, 34],
  [34, 1, 1, 1, 16, 1, 1, 1, 18, 20, 1, 18, 160, 3, 1, 18, 20],
  [16, 3, 1, 34, 20, 3, 18, 34, 20, 3, 18, 20, 3, 34, 7, 27, 28],
  [16, 1, 1, 16, 1, 1, 16, 1, 1, 1, 34, 1, 1, 7, 9, 3, 157],
  [21, 19, 1, 16, 3, 1, 16, 3, 1, 1, 1, 3, 18, 26, 3, 35, 23],
  [112, 34, 15, 24, 34, 1, 21, 15, 34, 15, 15, 34, 20, 28, 157, 24, 36],
];

// const sampleMap = `1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 4,5,6,7,8,9,10,11,12,13,14,1,1,1,1,1,1,1,1,1
// 15,16,17,18,19,20,21,22,23,24,25,26,27,1,1,1,1,1,1,1
// 28,29,30,31,32,33,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 101,102,103,104,105,106,107,108,109,110,113,114,115,116,1,1,1,1,1,1
// 111,112,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 36,35,34,133,145,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 40,39,38,134,146,41,42,1,1,1,1,1,1,1,1,1,1,1,1,1
// 45,44,43,129,140,46,47,1,1,1,1,1,1,1,1,1,1,1,1,1
// 50,49,48,131,142,51,52,1,1,1,1,1,1,1,1,1,1,1,1,1
// 55,54,53,136,148,56,57,1,1,1,1,1,1,1,1,1,1,1,1,1
// 93,92,91,128,139,94,95,1,1,1,1,1,1,1,1,1,1,1,1,1
// 83,82,81,135,147,84,85,1,1,1,1,1,1,1,1,1,1,1,1,1
// 88,87,86,137,143,89,90,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
// 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1`;

async function main() {
  const gameMap = await new GameMap("map", 25, 20).init();
  gameMap.importMap(sampleMap);
  gameMap.insertTerrain(ETerrain.ORANGESTARCOMTOWER, 0, 0);
  gameMap.insertUnit(ECountry.ORANGE_STAR, EUnit.INFANTRY, 0, 2);
  gameMap.render({ grid: true });
  gameMap.animate(0);
  // gameMap.insertUnit(ECountry.ORANGE_STAR, EUnit.MECH, 2, 1);
  // gameMap.render({ grid: true });
  // console.log(gameMap.gifs.get(`(1,1)`));
  // gameMap.units.forEach((x) => console.log(x));

  // console.log("buildings:", gameMap.buildings);
  // console.log("units:", gameMap.units);
  // console.log("mapMetadata:", gameMap.mapMetadata);
  // console.log("dynamic:", gameMap.assets.terrain.dynamic);

  // const c = document.createElement("canvas");
  // c.id = "map";
  // const el = document.getElementById("map");
  // if (!el) {
  //   throw new Error(`#map not found on page`);
  // }
  // el.replaceWith(c);
  // const ctx = c.getContext("2d") as CanvasRenderingContext2D;
  // const gif = await new GifLoader(
  //   "./sprites/units/ani/osinfantry.gif",
  //   ctx,
  //   0,
  //   50
  // ).init();
}

main();
